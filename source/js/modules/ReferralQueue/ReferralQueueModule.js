// Generated by CoffeeScript 1.3.3
(function() {

  define(['jquery', 'underscore', 'backbone', 'mustache', 'modules/ReferralQueue/ReferralQueueView', 'modules/ReferralQueue/ReferralTaskCollection', 'loader', 'Messenger'], function($, _, Backbone, Mustache, ReferralQueueView, ReferralTaskCollection, CanvasLoader, Messenger) {
    var ReferralQueue;
    return ReferralQueue = (function() {

      function ReferralQueue(view, app, params) {
        this.view = view;
        this.app = app;
        this.params = params;
        _.extend(this, Backbone.Events);
        this.controller = this.view.options.controller;
        this.TASKS = new ReferralTaskCollection();
        this.TASKS.url = this.controller.services.pxcentral + 'tasks';
        this.TASKS.digest = this.controller.user.get('digest');
        this.TASKS.email = this.controller.user.get('email');
        this.QUEUE_VIEW = new ReferralQueueView({
          module: this,
          collection: this.TASKS,
          view: this.view,
          owner: this.controller.user.get('email')
        });
        this.messenger = new Messenger(this.QUEUE_VIEW, this.QUEUE_VIEW.cid);
      }

      ReferralQueue.prototype.load = function() {
        return this.view.remove_loader(true);
      };

      ReferralQueue.prototype.render = function() {
        if (this.QUEUE_VIEW.render()) {
          return this.TASKS.getReferrals();
        }
      };

      return ReferralQueue;

    })();
  });

}).call(this);
