// Generated by CoffeeScript 1.3.3
(function() {

  define(['jquery', 'underscore', 'backbone', 'mustache'], function($, _, Backbone, Mustache) {
    var IPMChangeSet;
    return IPMChangeSet = (function() {

      function IPMChangeSet(POLICY, ACTION, VALUES, USER) {
        this.POLICY = POLICY;
        this.ACTION = ACTION;
        this.VALUES = VALUES;
        this.USER = USER;
      }

      IPMChangeSet.prototype.getPolicyChangeSet = function() {
        var body, bodyXML;
        body = this[_.underscored(this.ACTION)] || '';
        return bodyXML = Mustache.render(body, this.VALUES);
      };

      IPMChangeSet.prototype.getPolicyContext = function(policy) {
        var id;
        return id = policy.get('insight_id');
      };

      IPMChangeSet.prototype.policyChangeSetSkeleton = "<PolicyChangeSet schemaVersion=\"3.1\">\n  <Initiation>\n    <Initiator type=\"user\">{{initator.user}}</Initiator>\n  </Initiation>\n  <Target>\n    <Identifiers>\n      <Identifier name=\"InsightPolicyId\" value=\"{{identifier.insightPolicyId}}\" />\n    </Identifiers>\n    <SourceVersion>{{sourceverion.version}}</SourceVersion>\n  </Target>\n  <EffectiveDate>{{effectiveDate}}</EffectiveDate>\n  <AppliedDate>{{appliedDate}}</AppliedDate>\n  <Comment>{{comment}}</Comment>\n  {{body}}\n</PolicyChangeSet>";

      IPMChangeSet.prototype.make_payment = "<Ledger>\n  <LineItem value=\"{{paymentAmount}}\" type=\"PAYMENT\" timestamp=\"{{timestamp}}\">\n    <Memo ></Memo>\n    {{#line_items}}\n    <DataItem name=\"{{name}}\" value=\"{{value}}\" />\n    {{/line_items}}\n  </LineItem>\n</Ledger>\n<EventHistory>\n  <Event type=\"Payment\">\n    {{#events}}\n    <DataItem name=\"{{name}}\" value=\"{{value}}\" />\n    {{/events}}\n  </Event>\n</EventHistory>";

      return IPMChangeSet;

    })();
  });

}).call(this);
